
> ciro-server@1.0.0 dev
> nodemon --watch 'src/**/*.ts' --ignore 'src/**/*.spec.ts' --delay 2.5 --exec 'ts-node -r tsconfig-paths/register' src/main.ts

[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): src/**/*.ts[39m
[33m[nodemon] watching extensions: ts,js,json[39m
[32m[nodemon] starting `ts-node -r tsconfig-paths/register src/main.ts`[39m
>>> CONFIG: REDIS_DISABLED = false
>>> CONFIG: NO_BULL = false
>>> CONFIG: ENABLE_MODULE_GROUPING = false
>>> CONFIG: MODULE_GROUP = 0
>>> CONFIG: USE_FIXED_AUTH = false
>>> CONFIG: PROGRESSIVE_LOADING = false
2025-05-28T06:09:11.597Z [[32MINFO[39M] [ConfigService]: ConfigService initialized
>>> DATA-SOURCE MODULE: REDIS_DISABLED = false
>>> DATA-SOURCE MODULE: NO_BULL = false
>>> DATA-SOURCE MODULE: Importing BullModule.registerQueue
>>> INGESTION MODULE: REDIS_DISABLED = false
>>> INGESTION MODULE: NO_BULL = false
>>> INGESTION MODULE: Importing BullModule.registerQueue
>>> SERVICES MODULE: REDIS_DISABLED = false
>>> SERVICES MODULE: NO_BULL = false
>>> SERVICES MODULE: Importing BullModule.registerQueue
>>> JOBS MODULE: REDIS_DISABLED = false
>>> JOBS MODULE: NO_BULL = false
>>> JOBS MODULE: Importing BullModule.registerQueue
>>> DOCUMENT-PROCESSING MODULE: REDIS_DISABLED = false
>>> DOCUMENT-PROCESSING MODULE: NO_BULL = false
>>> DOCUMENT-PROCESSING MODULE: Importing BullModule.registerQueue
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[Bootstrap] [39m[32mStarting server initialization...[39m
===== DIAGNOSTIC EXPRESS SERVER =====
Starting a simple Express server to diagnose port binding issues
DIAGNOSTIC: Successfully bound to port 3001!
This confirms the port is available and can be bound to.
If NestJS is failing to bind, it is not a network or OS issue.
DIAGNOSTIC: Server closed successfully, continuing with NestJS bootstrap
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[Bootstrap] [39m[32mInitializing NestJS application...[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[Bootstrap] [39m[32mAbout to call NestFactory.create...[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[NestFactory] [39m[32mStarting Nest application...[39m[38;5;3m +1ms[39m
>>> INFO: Initializing Bull Redis queues
[32minfo[39m: EventManager initialized {"timestamp":"2025-05-28T06:09:21.339Z"}
Snowflake OAuth credentials are not configured. Set SNOWFLAKE_CLIENT_ID and SNOWFLAKE_CLIENT_SECRET environment variables.
>>> APP MODULE: Constructor called
>>> APP MODULE: Running with full module set
>>> PRISMA_SERVICE: Constructor starting...
>>> PRISMA_SERVICE: Constructor finished (super called).
{"level":"info","message":"DocumentChunkingService initialized"}
{"level":"info","message":"ElementChunkingService initialized"}
{"level":"info","message":"SemanticChunkingService initialized"}
2025-05-28T06:09:21.346Z [WARN] [ChunkingService-DEPRECATED]: ChunkingService is DEPRECATED and should not be directly injected. Use specialized chunking services (DocumentChunkingService, ElementChunkingService, SemanticChunkingService) instead.
2025-05-28T06:09:21.346Z [[32MINFO[39M] [EnhancedMetadataService]: EnhancedMetadataService initialized
2025-05-28T06:09:21.347Z [[32MINFO[39M] [WorkspaceService]: WorkspaceService initialized by NestJS DI
2025-05-28T06:09:21.347Z [[32MINFO[39M] [PythonExecutorService]: PythonExecutorService initialized
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InMemoryCacheService] [39m[32mInMemoryCacheService initialized[39m
2025-05-28T06:09:21.348Z [[33MWARN[39M] [ConfigService]: âš ï¸ Warning: ConfigService constructor called 2 times. Use getInstance() instead.
2025-05-28T06:09:21.348Z [[32MINFO[39M] [DocumentProcessorManager]: Document Processor Manager initialized
2025-05-28T06:09:21.349Z [[32MINFO[39M] [ResponseParsingService]: ResponseParsingService initialized
2025-05-28T06:09:21.349Z [[32MINFO[39M] [VisualizationPreparationService]: VisualizationPreparationService initialized
2025-05-28T06:09:21.350Z [[32MINFO[39M] [DataPreprocessingService]: DataPreprocessingService initialized
2025-05-28T06:09:21.353Z [[32MINFO[39M] [WebSocketService]: WebSocketService constructor called
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mPrismaModule dependencies initialized[39m[38;5;3m +7ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mBullModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mPassportModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mCacheModule dependencies initialized[39m[38;5;3m +0ms[39m
2025-05-28T06:09:21.354Z [[32MINFO[39M] [NlpProcessorService]: Initializing NlpProcessorService
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mStateModule dependencies initialized[39m[38;5;3m +1ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mDatasourcesProcessorsUtilsModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mMulterModule dependencies initialized[39m[38;5;3m +0ms[39m
2025-05-28T06:09:21.355Z [[32MINFO[39M] [WebSocketService]: WebSocketService constructor called
>>> Creating DataSourceManagementService with delayed document pipeline access
2025-05-28T06:09:21.356Z [[32MINFO[39M] [DataSourceManagementService]: DataSourceManagementService initialized
2025-05-28T06:09:21.356Z [[33MWARN[39M] [DataSourceManagementService]: DocumentPipelineService is not provided - document processing will not be available
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mHttpModule dependencies initialized[39m[38;5;3m +2ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mConfigHostModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mDiscoveryModule dependencies initialized[39m[38;5;3m +1ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mConfigModule dependencies initialized[39m[38;5;3m +6ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mConfigModule dependencies initialized[39m[38;5;3m +1ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mBullModule dependencies initialized[39m[38;5;3m +1ms[39m
2025-05-28T06:09:21.367Z [[32MINFO[39M] [SandboxManagerService]: SandboxManagerService initialized {"maxIdleTime":1800000,"maxContainers":10,"basePort":9000}
2025-05-28T06:09:21.367Z [[32MINFO[39M] [QdrantClientService]: QdrantClientService constructor: API URL set to http://localhost:6333
2025-05-28T06:09:21.367Z [[32MINFO[39M] [QdrantClientService]: >>> QDRANT_CLIENT_SERVICE: Initializing client in constructor...
2025-05-28T06:09:21.367Z [[32MINFO[39M] [QdrantClientService]: >>> QDRANT_CLIENT_SERVICE: Creating QdrantClient synchronously...
2025-05-28T06:09:21.380Z [[32MINFO[39M] [QdrantClientService]: >>> QDRANT_CLIENT_SERVICE: QdrantClient created and initialized synchronously
2025-05-28T06:09:21.381Z [[32MINFO[39M] [SandboxManagerService]: SandboxManagerService initialized {"maxIdleTime":1800000,"maxContainers":10,"basePort":9000}
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[S3Service] [39m[32mS3Service initialized with bucket: [39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[QueueService] [39m[32mQueueService initialized[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: gpt-4o from provider: openai[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel gpt-4o registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: gpt-4o-mini from provider: openai[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel gpt-4o-mini registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: o1-preview from provider: openai[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel o1-preview registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: o1-mini from provider: openai[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel o1-mini registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: text-embedding-3-large from provider: openai[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel text-embedding-3-large registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: text-embedding-3-small from provider: openai[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel text-embedding-3-small registered successfully[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mDefault OpenAI models registered[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: claude-3-5-sonnet-20241022 from provider: anthropic[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel claude-3-5-sonnet-20241022 registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: claude-3-5-haiku-20241022 from provider: anthropic[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel claude-3-5-haiku-20241022 registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: claude-3-opus-20240229 from provider: anthropic[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel claude-3-opus-20240229 registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: claude-3-sonnet-20240229 from provider: anthropic[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel claude-3-sonnet-20240229 registered successfully[39m
[95m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [95m  DEBUG[39m [38;5;3m[ModelRegistry] [39m[95mRegistering model: claude-3-haiku-20240307 from provider: anthropic[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mModel claude-3-haiku-20240307 registered successfully[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[ModelRegistry] [39m[32mDefault Anthropic models registered[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mBullModule dependencies initialized[39m[38;5;3m +4ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mBullModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mBullModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mBullModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mBullModule dependencies initialized[39m[38;5;3m +0ms[39m
2025-05-28T06:09:21.391Z [[32MINFO[39M] [QdrantCollectionService]: QdrantCollectionService initialized via NestJS DI
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mSandboxModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mS3Module dependencies initialized[39m[38;5;3m +1ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mQueueModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mJwtModule dependencies initialized[39m[38;5;3m +0ms[39m
2025-05-28T06:09:21.393Z [[32MINFO[39M] [QdrantIngestionService]: QdrantIngestionService initialized
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[EmbeddingService] [39m[32mEmbeddingService initialized. Caching: true, Default Model: text-embedding-3-small[39m
2025-05-28T06:09:21.394Z [[32MINFO[39M] [LlmAnalysisService]: LlmAnalysisService initialized with LLM abstraction layer
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mDashboardModule dependencies initialized[39m[38;5;3m +0ms[39m
2025-05-28T06:09:21.395Z [[32MINFO[39M] [QueryAnalysisService]: QueryAnalysisService initialized with LLM abstraction layer
2025-05-28T06:09:21.395Z [[32MINFO[39M] [AnalyticalRAGService]: AnalyticalRAGService initialized with LLM abstraction layer {"maxIterations":10,"analyticalModel":"gpt-4-turbo-preview"}
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mChatModule dependencies initialized[39m[38;5;3m +2ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mAutomationModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mWorkspaceModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mFileModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mOrganizationModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mLLMModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mDataSourceModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mAnalysisModule dependencies initialized[39m[38;5;3m +1ms[39m
2025-05-28T06:09:21.397Z [[32MINFO[39M] [BaseSearchService]: BaseSearchService initialized
2025-05-28T06:09:21.397Z [[32MINFO[39M] [QdrantSearchService]: QdrantSearchService initialized
2025-05-28T06:09:21.398Z [[32MINFO[39M] [CustomDocxProcessorService]: Initializing CustomDocxProcessorService
2025-05-28T06:09:21.398Z [[32MINFO[39M] [CustomDocxProcessorService]: CustomDocxProcessorService initialized
2025-05-28T06:09:21.398Z [[32MINFO[39M] [enhanced-excel]: Initializing enhanced-excel
2025-05-28T06:09:21.398Z [[32MINFO[39M] [JsonProcessorService]: Initializing JsonProcessorService
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[SnowflakeService] [39m[32mSnowflakeService (Module) initialized with Connector service instance[39m
2025-05-28T06:09:21.400Z [[32MINFO[39M] [QueryRouterService]: QueryRouterService initialized with LLM abstraction layer. Spellcheck: true, Model: o4-mini-2025-04-16, HighConf: 0.85, MidConf: 0.65
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mVectorModule dependencies initialized[39m[38;5;3m +1ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mCodeExecutionModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mOAuthModule dependencies initialized[39m[38;5;3m +1ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mAppModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mDocumentProcessingModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mSnowflakeModule dependencies initialized[39m[38;5;3m +1ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mAuthModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 256359  - [39m05/28/2025, 12:09:21 AM [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mSearchModule dependencies initialized[39m[38;5;3m +0ms[39m
